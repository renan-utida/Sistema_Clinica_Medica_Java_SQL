# Sistema de ClÃ­nica MÃ©dica

Um sistema completo para gestÃ£o de clÃ­nicas mÃ©dicas desenvolvido em Java, com interface console e grÃ¡fica (Swing), integrado ao banco de dados Oracle e com teste unitÃ¡rio.

## ğŸ“‹ Funcionalidades

- âœ… **Agendamento de Consultas** com validaÃ§Ãµes de negÃ³cio
- âœ… **Cadastro de Pacientes** com validaÃ§Ã£o de email
- âœ… **Cadastro de MÃ©dicos** com validaÃ§Ã£o de CRM
- âœ… **Interface Dupla**: Console (Scanner) e GrÃ¡fica (Swing)
- âœ… **IntegraÃ§Ã£o com Oracle Database**
- âœ… **ValidaÃ§Ãµes de Regras de NegÃ³cio**
- âœ… **Teste UnitÃ¡rio com JUnit 5 e Mockito**

## ğŸ—ï¸ Arquitetura

O projeto segue uma arquitetura em camadas bem definida:

```
com.example.clinic/
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ OracleConnectionFactory.java         # Factory de conexÃ£o Oracle
    â”œâ”€â”€ dao/
    â”‚   â””â”€â”€ jdbc/
    â”‚       â”œâ”€â”€ ConsultaJdbcRepository.java      # Acesso a dados de consultas
    â”‚       â”œâ”€â”€ MedicoDao.java                   # Acesso a dados de mÃ©dicos
    â”‚       â””â”€â”€ PacienteDao.java                 # Acesso a dados de pacientes
    â”œâ”€â”€ domain/
    â”‚   â”œâ”€â”€ Consulta.java                        # Entidade Consulta
    â”‚   â”œâ”€â”€ Medico.java                          # Entidade MÃ©dico
    â”‚   â””â”€â”€ Paciente.java                        # Entidade Paciente
    â”œâ”€â”€ service/
    â”‚   â”œâ”€â”€ AgendaService.java                   # Regras de agendamento
    â”‚   â”œâ”€â”€ MedicoService.java                   # Regras de mÃ©dicos
    â”‚   â””â”€â”€ PacienteService.java                 # Regras de pacientes
    â””â”€â”€ ui/
        â”œâ”€â”€ console/
        â”‚    â””â”€â”€ ConsoleMain.java                # Classe principal com interface de Console
        â””â”€â”€ swing/
             â””â”€â”€ SwingMain.java                  # Classe principal com interface de Swing

test/
    â””â”€â”€ com.example.clinic.domain.service/
        â””â”€â”€ AgendaServiceTest.java               # Testes unitÃ¡rios do AgendaService
```

## ğŸ› ï¸ Tecnologias Utilizadas

- **Java 17+**
- **Oracle Database** (JDBC)
- **Swing** (Interface GrÃ¡fica)
- **Scanner** (Interface Console)
- **JUnit 5** (Testes UnitÃ¡rios)
- **Mockito** (Mocking para testes)

## ğŸ“Š Banco de Dados

### Estrutura das Tabelas

```sql
-- Tabela de Pacientes
CREATE TABLE pacientes (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome VARCHAR2(120) NOT NULL,
  email VARCHAR2(120) NOT NULL UNIQUE
);

-- Tabela de MÃ©dicos
CREATE TABLE medicos (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome VARCHAR2(120) NOT NULL,
  crm  VARCHAR2(20) NOT NULL UNIQUE
);

-- Tabela de Consultas
CREATE TABLE consultas (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  paciente_id NUMBER NOT NULL REFERENCES pacientes(id),
  medico_id   NUMBER NOT NULL REFERENCES medicos(id),
  inicio      TIMESTAMP NOT NULL,
  fim         TIMESTAMP NOT NULL,
  CONSTRAINT chk_intervalo CHECK (fim > inicio)
);
```

### ConfiguraÃ§Ã£o da ConexÃ£o

Configure as variÃ¡veis de ambiente ou edite `OracleConnectionFactory.java`:

```bash
ORACLE_URL=jdbc:oracle:thin:@oracle.fiap.com.br:1521:orcl
ORACLE_USER=seu_usuario
ORACLE_PASSWORD=sua_senha
```

## ğŸš€ Como Executar

### PrÃ©-requisitos

1. **Java 17+** instalado
2. **Oracle Database** configurado
3. **Driver JDBC Oracle** no classpath
4. **JUnit 5** e **Mockito** para execuÃ§Ã£o dos testes
5. Executar os scripts `schema.sql` e `cargaInicial.sql`

### ExecuÃ§Ã£o

#### Interface Console
```bash
java com.example.clinic.ui.console.ConsoleMain.java
```

#### Interface GrÃ¡fica (Swing)
```bash
java com.example.clinic.ui.swing.SwingMain.java
```

#### ExecuÃ§Ã£o do Teste
```bash
# Com Maven
mvn test

# Com Gradle
gradle test

# Diretamente com JUnit
java -cp "classpath:junit5:mockito" org.junit.platform.console.ConsoleLauncher --class-path=build/classes --scan-class-path
```

## ğŸ“± Interfaces

### Menu Console
```
========================================
        SISTEMA DE CLÃNICA
========================================
1 - Agendar Consulta
2 - Cadastrar Paciente
3 - Cadastrar MÃ©dico
4 - Listar Pacientes
5 - Listar MÃ©dicos
0 - Sair
========================================
```

### Interface Swing
- **Menu Principal** com botÃµes para cada funcionalidade
- **Telas especÃ­ficas** para cada operaÃ§Ã£o
- **NavegaÃ§Ã£o** entre telas com CardLayout
- **ValidaÃ§Ãµes** em tempo real com mensagens de erro/sucesso

## âš™ï¸ Regras de NegÃ³cio

### Agendamento de Consultas
- âœ… **DuraÃ§Ã£o mÃ­nima**: 15 minutos
- âœ… **HorÃ¡rio comercial**: 08:00 Ã s 18:00
- âœ… **AntecedÃªncia mÃ­nima**: 60 minutos
- âœ… **ValidaÃ§Ã£o de conflitos**: MÃ©dico nÃ£o pode ter consultas simultÃ¢neas

### Cadastro de Pacientes
- âœ… **Nome obrigatÃ³rio**: mÃ­nimo 2, mÃ¡ximo 120 caracteres
- âœ… **Email vÃ¡lido**: formato e-mail padrÃ£o, mÃ¡ximo 120 caracteres
- âœ… **NormalizaÃ§Ã£o**: email convertido para lowercase

### Cadastro de MÃ©dicos
- âœ… **Nome obrigatÃ³rio**: mÃ­nimo 2, mÃ¡ximo 120 caracteres
- âœ… **CRM obrigatÃ³rio**: formato "CRM" + 4 a 6 dÃ­gitos (ex: CRM12345)
- âœ… **NormalizaÃ§Ã£o**: CRM convertido para uppercase

## ğŸ“‹ Formatos de Entrada

### Data/Hora
```
Formato: dd/MM/yyyy HH:mm
Exemplo: 21/08/2025 10:30
```

### CRM
```
Formato: CRM + 4-6 dÃ­gitos
Exemplos: CRM1234, CRM123456
```

### Email
```
Formato: padrÃ£o RFC
Exemplo: paciente@email.com
```

## ğŸ”§ Scripts SQL IncluÃ­dos

### `schema.sql`
- CriaÃ§Ã£o das tabelas
- DefiniÃ§Ã£o de constraints
- CriaÃ§Ã£o de Ã­ndices

### `cargaInicial.sql`
- Dados de exemplo para testes
- 5 pacientes prÃ©-cadastrados
- 5 mÃ©dicos prÃ©-cadastrados
- 5 consultas de exemplo

## ğŸ§ª Testes

O projeto inclui testes unitÃ¡rios abrangentes para validar as regras de negÃ³cio.

### Classe AgendaServiceTest
- **LocalizaÃ§Ã£o**: `test/com.example.clinic.domain.service/AgendaServiceTest.java`
- **Framework**: JUnit 5 com Mockito
- **Cobertura**: ValidaÃ§Ãµes de agendamento de consultas

#### CenÃ¡rios Testados:
1. **`deveAgendarConsultaComRegrasValidas()`**
   - Testa agendamento vÃ¡lido com todas as regras atendidas
   - Verifica se retorna ID da consulta criada

2. **`naoDeveAgendarComConflitoDeHorario()`**
   - Testa validaÃ§Ã£o de conflitos de horÃ¡rio
   - Verifica se lanÃ§a `IllegalStateException` quando mÃ©dico jÃ¡ tem consulta no horÃ¡rio

3. **`naoDeveAgendarSemAntecedenciaMinima()`**
   - Testa validaÃ§Ã£o de antecedÃªncia mÃ­nima (60 minutos)
   - Verifica se lanÃ§a `IllegalArgumentException` para agendamentos com menos antecedÃªncia

### Executando Testes EspecÃ­ficos

#### Via IDE
- Execute diretamente na IDE (IntelliJ, Eclipse, VS Code)
- Clique com botÃ£o direito em `AgendaServiceTest.java` â†’ "Run Tests"

#### Via Linha de Comando
```bash
# Executar apenas os testes do AgendaService
java -cp "classpath" org.junit.platform.console.ConsoleLauncher --select-class=com.example.clinic.domain.service.AgendaServiceTest

# Executar teste especÃ­fico
java -cp "classpath" org.junit.platform.console.ConsoleLauncher --select-method=com.example.clinic.domain.service.AgendaServiceTest#deveAgendarConsultaComRegrasValidas
```

### Testando Cadastros
1. Execute a aplicaÃ§Ã£o
2. Cadastre pacientes e mÃ©dicos
3. Verifique no Oracle SQL Developer:
```sql
SELECT * FROM pacientes;
SELECT * FROM medicos;
SELECT * FROM consultas;
```

### Testando ValidaÃ§Ãµes
- Teste CRM invÃ¡lido: `123456` (deve falhar)
- Teste email invÃ¡lido: `teste@` (deve falhar)
- Teste consulta fora do horÃ¡rio: `19:00` (deve falhar)
- Teste conflito de horÃ¡rio: mesmo mÃ©dico, mesmo horÃ¡rio (deve falhar)

## ğŸ¯ Exemplos de Uso

### Agendamento via Console
```
ID do paciente: 1
ID do mÃ©dico: 1
InÃ­cio da consulta (dd/MM/yyyy HH:mm): 22/08/2025 14:30
DuraÃ§Ã£o em minutos: 30
```

### Cadastro de Paciente
```
Nome do paciente: JoÃ£o Silva
Email do paciente: joao@email.com
```

### Cadastro de MÃ©dico
```
Nome do mÃ©dico: Dr. Carlos Lima
CRM do mÃ©dico: CRM98765
```

## ğŸ“„ Estrutura do Projeto

```
projeto-clinica/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ com/example/clinic/
â”‚       â”œâ”€â”€ config/
â”‚       â”œâ”€â”€ dao.jdbc/
â”‚       â”œâ”€â”€ domain/
â”‚       â”œâ”€â”€ service/
â”‚       â””â”€â”€ ui/
â”‚           â”œâ”€â”€ console/
â”‚           â”‚    â””â”€â”€ ConsoleMain.java
â”‚           â””â”€â”€ swing/
â”‚                â””â”€â”€ SwingMain.java
â”œâ”€â”€ test/
â”‚   â””â”€â”€ com/example/clinic/domain/service/
â”‚       â””â”€â”€ AgendaServiceTest.java          
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ schema.sql
â”‚   â””â”€â”€ cargaInicial.sql
â””â”€â”€ README.md

```

## ğŸ¤ ContribuiÃ§Ã£o

1. Fork o projeto
2. Crie uma branch para sua feature
3. Commit suas mudanÃ§as
4. Push para a branch
5. Abra um Pull Request

## ğŸ“ LicenÃ§a

Este projeto Ã© desenvolvido para fins educacionais.

## ğŸ‘¨â€ğŸ’» Autor

**Renan Dias Utida** - RM 558540
- LinkedIn: [Renan Dias Utida](https://www.linkedin.com/in/renan-dias-utida-1b1228225/)
- GitHub: [renan-utida](https://github.com/renan-utida)

---

**ğŸ’¡ Dica**: Para melhor experiÃªncia, use a interface Swing que oferece uma navegaÃ§Ã£o mais intuitiva entre as funcionalidades!
